# Enzyme & Jest Testing (Basics)

## Docs

1. [Enzyme Docs](https://enzymejs.github.io/enzyme/)

2. [Jest Docs](https://jestjs.io/docs/api)

## Pre Installation Notes from Course

1. On October 23, 2020, create-react-app updated to React 17. Since running npx create-react-app as recommended in this course will use the latest version of create-react-app, your apps will be using React 17 as well.

2. Unfortunately, the official enzyme-adapter-react-17 is not yet available. As of the March 2021 update, the course uses uses the unofficial @wojtekmaj/enzyme-adapter-react-17 adapter. When the official adapter becomes available, I will update the course lectures to reflect this.

3. There may be some dependency issues when installing the unofficial adapter (or when making installs afterward). Running the install with the `--legacy-peer-deps` flag should allow the install to continue.

## Installation and Setup

```bash
npm install --save-dev enzyme @wojtekmaj/enzyme-adapter-react-17
```

1. The adapter helps translate react code to enzyme code.

2. Finally we setup Enzyme by configuring it with our adapter

   ```js
   import Enzyme from "enzyme";
   import EnzymeAdapter from "@wojtekmaj/enzyme-adapter-react-17";

   Enzyme.configure({ adapter: new EnzymeAdapter() });
   ```

## Testing Beginner: Simple Click Counter

A Simple App, with a button and counter display.

Clciking button Increses value in counter display.

### Setting Up our Tests

We are going to have 5 tests in total.
The first test is very generic.
The last one we want to think about. See the comments

```js
import Enzyme, { shallow } from "enzyme";
import EnzymeAdapter from "@wojtekmaj/enzyme-adapter-react-17";
import App from "./App";

Enzyme.configure({ adapter: new EnzymeAdapter() });

test("renders without err", () => {});

test("renders increment button", () => {});

test("renders counter display", () => {});

test("counter display starts at 0", () => {});

// Here we will test that it increments the counter display,
// ie: test behaviour/functionality
// And NOT test the state,
// ie: that it increments counter state (implementation)
test("clicking button increments counter display", () => {});
```

### Data Test Attributes (DTA)

```jsx
function App() {
  return <div data-test=""></div>;
}
```

1. Data Test Attributes to test rendering

   1. Added to the top lvl element of a component

2. And if a component with that DTA gets rendered, our test passes

3. Why not just use id or class? Why new attribute?

   1. id and class have their own uses in a production app

   2. Which means they are more susceptible to change in case of refactor

   3. DTA is only for testing

   4. data-test is the conventional name for this attribute but you can choose any name

   5. Finally many people don't want DTAs in their production have. We will see how to remove them in production later.

4. Convention is to use `snake-case` or `kebab-case` for DTAs

5. Finding [DTA in a shallow wrapper using enzyme](https://enzymejs.github.io/enzyme/docs/api/ShallowWrapper/find.html)

### Removing Data Test Attributes for Production

1. Need the following pacakge `babel-plugin-react-remove-properties`

   ```bash
   yarn add -D babel-plugin-react-remove-properties
   ```

2. `Optional step` if we are using create-react-app. Need to run the following. What it does is take the config files and makes it editable by us.

   ```bash
   npm run eject
   # or
   yarn run eject
   ```

3. This will change the package.json and add a bunch of configs there, but first it will ask me to commit my work, in case I want to revert back.

4. If I haven't commited my work it will fail
